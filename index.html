<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>GraphViz WASM</title>

    <script>
        const dotStr = `
        digraph G {
            node [shape=rect];

            subgraph cluster_0 {
                style=filled;
                color=lightgrey;
                node [style=filled,color=white];
                a0 -> a1 -> a2 -> a3;
                label = "process #1";
            }

            subgraph cluster_1 {
                node [style=filled];
                b0 -> b1 -> b2 -> b3;
                label = "process #2";
                color=blue
            }

            start -> a0;
            start -> b0;
            a1 -> b3;
            b2 -> a3;
            a3 -> a0;
            a3 -> end;
            b3 -> end;

            start [shape=Mdiamond,label=<<TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" >
                  <TR>
                    <TD COLSPAN="3" BGCOLOR="azure3" >
                      <b><FONT FACE="Times-Roman" POINT-SIZE="12.0" >one obj</FONT></b>
                    </TD>
                  </TR>
                        <TR>
                          <TD PORT="in1" BGCOLOR="white">in1<br/>:In1</TD>
                          <TD ROWSPAN="2" BGCOLOR="azure3"> some text </TD>
                          <TD PORT="out1"  BGCOLOR="0.5 0.5 0.5">out1<br/>:Out1</TD>
                        </TR>
                        <TR>
                          <TD PORT="in2"   HREF="somepage.html" BGCOLOR="0.45 0.5 0.75">in2<br/>:In2</TD>
                          <TD PORT="out2"  HREF="somepage.html"   BGCOLOR="0.8 0.5 1">out2<br/>:Out2</TD>
                        </TR>
                  </TABLE>>];
            end [shape=Msquare];
        }
    `;
    </script>
</head>

<body>
    <h3>Version</h3>
    <div id="version"></div>
    <script type="module">
        import dot from "./dist/graphviz.js";
        const version = await dot.graphvizVersion();
        document.getElementById("version").innerHTML = version;
    </script>
    <h3>ESM 1</h3>
    <div id="ESM"></div>
    <script type="module">
        import dot from "./dist/graphviz.js";
        const svg = dot`graph { n0 -- n1 -- n2 -- n3 -- n0; }`;
        document.getElementById("ESM").appendChild(svg);
    </script>
    <hr>
    <h3>ESM 2</h3>
    <div id="ESM2"></div>
    <script type="module">
        import dot from "./dist/graphviz.js";
        const svg_esm2 = dot([dotStr]);
        document.getElementById("ESM2").appendChild(svg_esm2);
    </script>
    <hr>
    <h3>Image</h3>
    <div id="image"></div>
    <script type="module">
        import dot from "./dist/graphviz.js";
        const newDot = await dot.options({ engine: "neato", images: [{ path: "https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png", width: "272px", height: "92px" }] });
        const svg2 = newDot(['digraph { a[image="https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png"]; }']);
        document.getElementById("image").appendChild(svg2);
    </script>
    <hr>
    <h3>Syntax Error</h3>
    <div id="error"></div>
    <script type="module">
        import dot from "./dist/graphviz.js";
        try {
            const svg3 = await dot([dotStr.replace("color=white", "color==white")]);
            document.getElementById("error").appendChild(svg3);
        } catch (e) {
            document.getElementById("error").innerText = e.message;
        }
    </script>
    <hr>
    <h3>IIFE</h3>
    <div id="IIFE"></div>
    <script src="./dist/graphviz.min.js"></script>
    <script>
        O.then(function (dot) {
            var svg = dot`graph { n0 -- n1 -- n2 -- n3 -- n0; }`;
            document.getElementById("IIFE").appendChild(svg);
        });
    </script>
    <hr>
    <h3>d3-require</h3>
    <div id="d3require"></div>
    <script src="https://cdn.jsdelivr.net/npm/d3-require@1"></script>
    <script>
        d3.require("./dist/graphviz.min.js").then(dot => {
            var svg = dot`graph { n0 -- n1 -- n2 -- n3 -- n0; }`;
            document.getElementById("d3require").appendChild(svg);
        });
    </script>
    <hr>
    <iframe src="./index-requirejs.html">
    </iframe>
</body>

</html>